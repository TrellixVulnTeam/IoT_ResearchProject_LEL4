---
title: "subActPlots"
author: "AlistairGJ"
date: "14/11/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(message = FALSE, warning = FALSE)
library(ggplot2)
library(ggridges)
library(dplyr)
library(viridis)
library(lubridate)
library(ggExtra)
library(tidyr)
library(readr)
library(cowplot)
library(data.table)
```

```{r}
dsPRE <- read_csv('/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/intermediate_datasets/FINAL/S1SubActivities_preprocessedWfeatures.csv', 
               col_types = cols(subActNum = col_integer(),
               dayNumeric = col_character(),
               HOUR = col_character()))
dsPRE$start <- ymd_hms(dsPRE$start)
dsPRE$start <- force_tz(dsPRE$start, "America/New_York")
dsPRE$end <- ymd_hms(dsPRE$end)
dsPRE$end <- force_tz(dsPRE$end, "America/New_York")
dsPRE$subAct <- as.factor(dsPRE$subAct)
dsPRE$DAY <- as.factor(dsPRE$DAY)
```

```{r}
dsPOST <- read_csv('/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/intermediate_datasets/FINAL/S1SubActivities_temporalFeaturesCLEANSED.csv', 
               col_types = cols(subActNum = col_integer(),
               dayNumeric = col_character(),
               HOUR = col_character()))
dsPOST$start <- ymd_hms(dsPOST$start)
dsPOST$start <- force_tz(dsPOST$start, "America/New_York")
dsPOST$end <- ymd_hms(dsPOST$end)
dsPOST$end <- force_tz(dsPOST$end, "America/New_York")
dsPOST$subAct <- as.factor(dsPOST$subAct)
dsPOST$DAY <- as.factor(dsPOST$DAY)
```

```{r fig.width=10, fig.height=2}
subActNum = unique(dsPRE$subActNum)

strip_plot <- function(ds, i) {
  ds_filtered <- ds %>% filter(subActNum == i)
  d <- ggplot(ds_filtered, aes(durationSec, DAY))
  d <- d + geom_bin2d() + scale_y_discrete(limits=c('Sun', 'Sat', 'Fri', 'Thu', 'Wed', 'Tue', 'Mon')) +
    scale_x_continuous(expand = c(0.025, 0.025)) +
    scale_fill_viridis(breaks = function(x) unique(floor(pretty(seq(0, (max(x) + 1) * 1.1)))), direction = - 1) +
    theme_grey() +
    theme(legend.position = "none", axis.title.y=element_blank(), text = element_text(size=7),
          axis.text.x = element_text(size = 6, angle = 0)) + 
    labs(x = "Duration (Seconds)")

  e <- ggplot(ds_filtered, aes(HOUR, DAY))
  e <- e + geom_bin2d() + 
    scale_y_discrete(limits=c('Sun', 'Sat', 'Fri', 'Thu', 'Wed', 'Tue', 'Mon')) +
    scale_x_discrete(limits=c('4','5','6','7','8','9','10','11','12','13','14','15',
                              '16','17','18','19','20','21','22','23','0','1'), 
                     breaks=c('4', '5', '6','7','8','9','10','11','12','13','14','15',
                              '16','17','18','19','20','21','22','23','0','1'), expand = c(0.025, 0.025)) +
    scale_fill_viridis(breaks = function(x) unique(floor(pretty(seq(0, (max(x) + 1) * 1.1)))), direction = - 1) +
    theme_grey() +
    theme(legend.position = "right", axis.title.y=element_blank(), 
          text = element_text(size=7),
          axis.text.x = element_text(size = 6, angle = 0),
          legend.key.size = unit(1,"line")) + labs(x = "Hour of Day")
  
  f <- ggplot(ds_filtered, aes(x = DAY, y = durationSec, fill = DAY))
  f <- f + geom_boxplot() + coord_flip() +
    scale_x_discrete(limits=c('Sun', 'Sat', 'Fri', 'Thu', 'Wed', 'Tue', 'Mon')) +
    scale_y_continuous(expand = c(0.025, 0.025)) +
    theme_grey() +
    theme(legend.position = "none", axis.title.y=element_blank(), text = element_text(size=7),
          axis.text.x = element_text(size = 6, angle = 0)) + 
    labs(x = NULL, y = "Duration (Seconds)")

  plot_row = plot_grid(f, d, e, labels = "AUTO", label_size = 6, nrow = 1,  rel_widths = c(1, 1, 1.2))
  plot_grid(plot_row, ncol = 1, rel_heights = c(0.1, 1))
  
}
```

```{r fig.width=10, fig.height=4}
#p1 <- strip_plot(dsPRE, 64) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
#p2 <- strip_plot(dsPOST, 64) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
#plot_grid(p1, p2,
#  nrow = 2,
#  label_size = 8,
#  align = "v"
#)
```












#### Bathroom Cabinet (SubActNum 67)

```{r fig.width=10, fig.height=4}
p1 <- strip_plot(dsPRE, 67) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
p2 <- strip_plot(dsPOST, 67) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
plot_grid(p1, p2,
  nrow = 2,
  label_size = 8,
  align = "v"
)

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct67.png", 
       plot = last_plot(), device = png(), 
       scale = 1.5, width = 18, height = 6, units = c("cm"), dpi = 300)
```

#### Bathroom Toiletflush (SubActNum 100)

```{r fig.width=10, fig.height=4}
p1 <- strip_plot(dsPRE, 100) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
p2 <- strip_plot(dsPOST, 100) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
plot_grid(p1, p2,
  nrow = 2,
  label_size = 8,
  align = "v"
)

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct100.png", 
       plot = last_plot(), device = png(), 
       scale = 1.5, width = 18, height = 6, units = c("cm"), dpi = 300)
```


#### Bathroom Lightswitch (SubActNum 101)

```{r fig.width=10, fig.height=2}
strip_plot(dsPRE, 101) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct101.png", 
       plot = last_plot(), device = png(), 
       scale = 1.5, width = 18, height = 3, units = c("cm"), dpi = 300)
```


#### Bathroom Medicine Cabinet (SubActNum 57)

```{r fig.width=10, fig.height=4}
p1 <- strip_plot(dsPRE, 57) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
p2 <- strip_plot(dsPOST, 57) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
plot_grid(p1, p2,
  nrow = 2,
  label_size = 8,
  align = "v"
)

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct57.png", 
			plot = last_plot(), device = png(), 
      scale = 1.5, width = 18, height = 6, units = c("cm"), dpi = 300)
```



#### Study Drawer (SubActNum 82)

```{r fig.width=10, fig.height=4}
p1 <- strip_plot(dsPRE, 82) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
p2 <- strip_plot(dsPOST, 82) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
plot_grid(p1, p2,
  nrow = 2,
  label_size = 8,
  align = "v"
)

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct82.png", 
			plot = last_plot(), device = png(), 
      scale = 1.5, width = 18, height = 6, units = c("cm"), dpi = 300)
```


#### Bedroom Drawer (SubActNum 146)

```{r fig.width=10, fig.height=4}
p1 <- strip_plot(dsPRE, 146) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
p2 <- strip_plot(dsPOST, 146) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
plot_grid(p1, p2,
  nrow = 2,
  label_size = 8,
  align = "v"
)

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct146.png", 
			plot = last_plot(), device = png(), 
      scale = 1.5, width = 18, height = 6, units = c("cm"), dpi = 300)
```


#### Kitchen Cabinet (SubActNum 132)

```{r fig.width=10, fig.height=4}
p1 <- strip_plot(dsPRE, 132) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
p2 <- strip_plot(dsPOST, 132) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
plot_grid(p1, p2,
  nrow = 2,
  label_size = 8,
  align = "v"
)

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct132.png", 
			plot = last_plot(), device = png(), 
      scale = 1.5, width = 18, height = 6, units = c("cm"), dpi = 300)
```


#### Kitchen Microwave (SubActNum 143)

```{r fig.width=10, fig.height=4}
p1 <- strip_plot(dsPRE, 143) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
p2 <- strip_plot(dsPOST, 143) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
plot_grid(p1, p2,
  nrow = 2,
  label_size = 8,
  align = "v"
)

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct143.png", 
			plot = last_plot(), device = png(), 
      scale = 1.5, width = 18, height = 6, units = c("cm"), dpi = 300)
```


#### Kitchen Door (SubActNum 141)

```{r fig.width=10, fig.height=4}
p1 <- strip_plot(dsPRE, 141) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
p2 <- strip_plot(dsPOST, 141) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
plot_grid(p1, p2,
  nrow = 2,
  label_size = 8,
  align = "v"
)

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct141.png", 
			plot = last_plot(), device = png(), 
      scale = 1.5, width = 18, height = 6, units = c("cm"), dpi = 300)
```


#### Bathroom Shower Faucet (SubActNum 93)

```{r fig.width=10, fig.height=4}
p1 <- strip_plot(dsPRE, 93) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
p2 <- strip_plot(dsPOST, 93) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
plot_grid(p1, p2,
  nrow = 2,
  label_size = 8,
  align = "v"
)

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct93.png", 
			plot = last_plot(), device = png(), 
      scale = 1.5, width = 18, height = 6, units = c("cm"), dpi = 300)
```


#### Kitchen Drawer (SubActNum 125)

```{r fig.width=10, fig.height=4}
p1 <- strip_plot(dsPRE, 125) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
p2 <- strip_plot(dsPOST, 125) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
plot_grid(p1, p2,
  nrow = 2,
  label_size = 8,
  align = "v"
)

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct125.png", 
			plot = last_plot(), device = png(), 
      scale = 1.5, width = 18, height = 6, units = c("cm"), dpi = 300)
```


#### Kitchen Dishwasher (SubActNum 70)

```{r fig.width=10, fig.height=4}
p1 <- strip_plot(dsPRE, 70) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
p2 <- strip_plot(dsPOST, 70) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
plot_grid(p1, p2,
  nrow = 2,
  label_size = 8,
  align = "v"
)

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct70.png", 
			plot = last_plot(), device = png(), 
      scale = 1.5, width = 18, height = 6, units = c("cm"), dpi = 300)
```


#### Kitchen Refrigerator (SubActNum 126)

```{r fig.width=10, fig.height=2}
strip_plot(dsPRE, 126) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct126.png", 
       plot = last_plot(), device = png(), 
       scale = 1.5, width = 18, height = 3, units = c("cm"), dpi = 300)
```


#### Bathroom Sink Faucet - Cold (SubActNum 88)

```{r fig.width=10, fig.height=2}
strip_plot(dsPRE, 88) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct88.png", 
       plot = last_plot(), device = png(), 
       scale = 1.5, width = 18, height = 3, units = c("cm"), dpi = 300)
```


#### Bathroom Sink Faucet - Hot (SubActNum 68)

```{r fig.width=10, fig.height=4}
p1 <- strip_plot(dsPRE, 68) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
p2 <- strip_plot(dsPOST, 68) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
plot_grid(p1, p2,
  nrow = 2,
  label_size = 8,
  align = "v"
)

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct68.png", 
       plot = last_plot(), device = png(), 
       scale = 1.5, width = 18, height = 6, units = c("cm"), dpi = 300)
```


#### Foyer Door (SubActNum 140)

```{r fig.width=10, fig.height=2}
strip_plot(dsPRE, 140) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct140.png", 
       plot = last_plot(), device = png(), 
       scale = 1.5, width = 18, height = 3, units = c("cm"), dpi = 300)
```



#### Kitchen Freezer (SubActNum 137)

```{r subAct137, echo=FALSE, fig.cap="A caption", out.width = '100%'}
p1 <- strip_plot(dsPRE, 137) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
p2 <- strip_plot(dsPOST, 137) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
plot_grid(p1, p2,
  nrow = 2,
  label_size = 8,
  align = "v"
)

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct137.png", 
       plot = last_plot(), device = png(), 
       scale = 1.5, width = 18, height = 6, units = c("cm"), dpi = 300)
```


#### Kitchen Burner (SubActNum 106)

```{r subAct106, echo=FALSE, fig.cap="A caption", out.width = '100%'}
strip_plot(dsPRE, 106) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct106.png", 
       plot = last_plot(), device = png(), 
       scale = 1.5, width = 18, height = 3, units = c("cm"), dpi = 300)
```


#### Kitchen Lightswitch (SubActNum 105)

```{r subAct105, echo=FALSE, fig.cap="A caption", out.width = '100%'}
p1 <- strip_plot(dsPRE, 105) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
p2 <- strip_plot(dsPOST, 105) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
plot_grid(p1, p2,
  nrow = 2,
  label_size = 8,
  align = "v"
)

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct105.png", 
       plot = last_plot(), device = png(), 
       scale = 1.5, width = 18, height = 6, units = c("cm"), dpi = 300)
```


#### Study Lightswitch (TYPO) (SubActNum 92)

```{r subAct92, echo=FALSE, fig.cap="A caption", out.width = '100%'}
p1 <- strip_plot(dsPRE, 92) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
p2 <- strip_plot(dsPOST, 92) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
plot_grid(p1, p2,
  nrow = 2,
  label_size = 8,
  align = "v"
)

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct92.png", 
       plot = last_plot(), device = png(), 
       scale = 1.5, width = 18, height = 6, units = c("cm"), dpi = 300)
```



#### Bathroom Door (SubActNum 130)

```{r subAct130, echo=FALSE, fig.cap="A caption", out.width = '100%'}
p1 <- strip_plot(dsPRE, 130) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
p2 <- strip_plot(dsPOST, 130) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
plot_grid(p1, p2,
  nrow = 2,
  label_size = 8,
  align = "v"
)

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct130.png", 
       plot = last_plot(), device = png(), 
       scale = 1.5, width = 18, height = 6, units = c("cm"), dpi = 300)
```


#### Foyer Lightswitch (SubActNum 104)

```{r subAct104, echo=FALSE, fig.cap="A caption", out.width = '100%'}
strip_plot(dsPRE, 104) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct104.png", 
       plot = last_plot(), device = png(), 
       scale = 1.5, width = 18, height = 3, units = c("cm"), dpi = 300)
```










#### Kitchen Toaster (SubActNum 131)

```{r subAct131, echo=FALSE, fig.cap="A caption", out.width = '100%'}
p1 <- strip_plot(dsPRE, 131) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
p2 <- strip_plot(dsPOST, 131) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
plot_grid(p1, p2,
  nrow = 2,
  label_size = 8,
  align = "v"
)

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct131.png", 
       plot = last_plot(), device = png(), 
       scale = 1.5, width = 18, height = 3, units = c("cm"), dpi = 300)
```

#### Bathroom Exhaust Fan (SubActNum 96)

```{r subAct96, echo=FALSE, fig.cap="A caption", out.width = '100%'}
strip_plot(dsPRE, 96) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct96.png", 
       plot = last_plot(), device = png(), 
       scale = 1.5, width = 18, height = 3, units = c("cm"), dpi = 300)
```

#### Bedroom Lightswitch (SubActNum 108)

```{r subAct108, echo=FALSE, fig.cap="A caption", out.width = '100%'}
strip_plot(dsPRE, 108) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct108.png", 
       plot = last_plot(), device = png(), 
       scale = 1.5, width = 18, height = 3, units = c("cm"), dpi = 300)
```

#### Kitchen Oven (SubActNum 129)

```{r subAct129, echo=FALSE, fig.cap="A caption", out.width = '100%'}
strip_plot(dsPRE, 129) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct129.png", 
       plot = last_plot(), device = png(), 
       scale = 1.5, width = 18, height = 3, units = c("cm"), dpi = 300)
```

#### Livingroom DVD (SubActNum 56)

DROPPED - One value only * 2

```{r subAct56, echo=FALSE, fig.cap="A caption", out.width = '100%'}
strip_plot(dsPRE, 56) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct56.png", 
       plot = last_plot(), device = png(), 
       scale = 1.5, width = 18, height = 3, units = c("cm"), dpi = 300)
```

#### Livingroom Lamp (SubActNum 76)

```{r subAct76, echo=FALSE, fig.cap="A caption", out.width = '100%'}
strip_plot(dsPRE, 76) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct76.png", 
       plot = last_plot(), device = png(), 
       scale = 1.5, width = 18, height = 3, units = c("cm"), dpi = 300)
```

#### Bedroom Jewelrybox (SubActNum 139)

```{r subAct139, echo=FALSE, fig.cap="A caption", out.width = '100%'}
strip_plot(dsPRE, 139) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct139.png", 
       plot = last_plot(), device = png(), 
       scale = 1.5, width = 18, height = 3, units = c("cm"), dpi = 300)
```

#### Kitchen Washingmachine (SubActNum 142)

```{r subAct142, echo=FALSE, fig.cap="A caption", out.width = '100%'}
strip_plot(dsPRE, 142) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct142.png", 
       plot = last_plot(), device = png(), 
       scale = 1.5, width = 18, height = 3, units = c("cm"), dpi = 300)
```

#### Kitchen Laundry Dryer (SubActNum 90)

```{r subAct90, echo=FALSE, fig.cap="A caption", out.width = '100%'}
strip_plot(dsPRE, 90) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct90.png", 
       plot = last_plot(), device = png(), 
       scale = 1.5, width = 18, height = 3, units = c("cm"), dpi = 300)
```

#### Kitchen Garbage Disposal (SubActNum 98)

```{r subAct98, echo=FALSE, fig.cap="A caption", out.width = '100%'}
strip_plot(dsPRE, 98) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct98.png", 
       plot = last_plot(), device = png(), 
       scale = 1.5, width = 18, height = 3, units = c("cm"), dpi = 300)
```

#### Livingroom Lightswitch (SubActNum 107)

```{r subAct107, echo=FALSE, fig.cap="A caption", out.width = '100%'}
p1 <- strip_plot(dsPRE, 107) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
p2 <- strip_plot(dsPOST, 107) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))
plot_grid(p1, p2,
  nrow = 2,
  label_size = 8,
  align = "v"
)

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct107.png", 
       plot = last_plot(), device = png(), 
       scale = 1.5, width = 18, height = 3, units = c("cm"), dpi = 300)
```


#### Foyer Closet (SubActNum 81)

DROPPED

```{r subAct81, echo=FALSE, fig.cap="A caption", out.width = '100%'}
strip_plot(dsPRE, 81) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct81.png", 
       plot = last_plot(), device = png(), 
       scale = 1.5, width = 18, height = 3, units = c("cm"), dpi = 300)
```

#### Kitchen Cereal (SubActNum 145)

DROPPED

```{r subAct145, echo=FALSE, fig.cap="A caption", out.width = '100%'}
strip_plot(dsPRE, 145) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct145.png", 
       plot = last_plot(), device = png(), 
       scale = 1.5, width = 18, height = 3, units = c("cm"), dpi = 300)
```

#### Kitchen Containers (SubActNum 60)

DROPPED

```{r subAct60, echo=FALSE, fig.cap="A caption", out.width = '100%'}
strip_plot(dsPRE, 60) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct60.png", 
       plot = last_plot(), device = png(), 
       scale = 1.5, width = 18, height = 3, units = c("cm"), dpi = 300)
```

#### Kitchen Coffee Machine (SubActNum 119)

```{r subAct119, echo=FALSE, fig.cap="A caption", out.width = '100%'}
strip_plot(dsPRE, 119) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct119.png", 
       plot = last_plot(), device = png(), 
       scale = 1.5, width = 18, height = 3, units = c("cm"), dpi = 300)
```

#### Bedroom Lamp (SubActNum 64)

DROPPED

```{r subAct64, echo=FALSE, fig.cap="A caption", out.width = '100%'}
strip_plot(dsPRE, 64) + theme(plot.margin = unit(c(0, 0, 0, 0), "cm"))

ggsave("/Users/alistairgj/Documents/GitHub/IoT_ResearchProject/IoT_November/images/subAct64.png", 
       plot = last_plot(), device = png(), 
       scale = 1.5, width = 18, height = 3, units = c("cm"), dpi = 300)
```






